<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Qlik API Barebones</title>

  <link rel="stylesheet" href="https://playground-sense.qlik.com/showcase/resources/autogenerated/qlik-styles.css">
  <link href="style.css" rel="stylesheet">
  <script type="text/javascript" src="https://d3js.org/d3.v3.min.js"></script>
  <script type="text/javascript" src="https://d3js.org/d3.v4.min.js"></script>
  <script type="text/javascript" src="https://unpkg.com/topojson@3"></script>
</head>

<body>
  <h1></h1>
  <div id="bar"><div class="bars"></div></div>
  <div id="map"></div>
  <div id="pie"></div>

  <script type="text/javascript" src="https://playground-sense.qlik.com/showcase/resources/assets/external/requirejs/require.js"></script>
  <script type="text/javascript" src="/resources/script.js"></script>
  <script type="text/javascript">

    d3.select("h1").text("Simple d3 using verion " + d3.version);

    // Bar chart
    var data = [1, 8, 15, 16, 23, 42, 35, 4, 20, 15, 2, 40, 4, 20, 15, 2, 40];

    var x = d3.scale.linear()
        .domain([0, d3.max(data)])
        .range([0, 420]);

    d3.select(".bars")
        .selectAll("div")
            .data(data)
        .enter().append("div")
            .style("width", function(d) { return x(d) + "px"; })
            .text(function(d) { return d; });

    // Map chart
    $(document).ready(function(){
        var w = 1000;
        var h = 480;
        var projection = d3.geo.equirectangular();
        var path = d3.geo.path().projection(projection);
        var svg = d3.select('body')
                    .append('svg')
                    .attr('width', w)
                    .attr('height', h)
        
        svg.append('rect')
            .attr('width', w)
            .attr('height', h)
            .attr('fill', 'white');
        
        var g = svg.append("g");
        
        d3.json('https://d3js.org/world-50m.v1.json', function(error, data){
            if(error) console.log(error);
            
            g.append('path')
            .datum(topojson.feature(data, data.objects.countries))
            .attr('d', path);
            
            var zoom = d3.behaviour.zoom()
            .on('zoom', function(){
                g.attr("transform", "translate(" + d3.event.scale + ")");
                g.selectAll("path")
                    .attr("d", path.projection(projection));
                svg.call(zoom);
                
            })
            
        })
        
    })
  function test_cb(data) {
      console.log(data[0]["Lead entity"]);
  }
    main(test_cb);
  </script>
</body>

</html>
